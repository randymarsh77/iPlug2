parameters:
  name: ''
  path: ''
  formatStr: ''
  artifactName: ''
  extStr: ''

steps:
  - bash: |
      rm -r $BUILD_ARTIFACTSTAGINGDIRECTORY/*
    displayName: Clean temporary directory

  - bash: |
      outputDir=$BUILD_ARTIFACTSTAGINGDIRECTORY/${{parameters.formatStr}}/${{parameters.name}}
      mkdir -p $outputDir
      cd ${{parameters.path}}/${{parameters.name}}/build-mac/
      zip -r ${{parameters.name}}_${{parameters.formatStr}}.zip ${{parameters.name}}.{{parameters.extStr}}*
      mv ${{parameters.name}}_${{parameters.formatStr}}.zip $outputDir
    displayName: Organize artifact

  - task: PublishPipelineArtifact@0
    inputs:
      artifactName: 'MAC_${{parameters.formatStr}}_${{ parameters.artifactName }}'
      targetPath: '$(Build.ArtifactStagingDirectory)/${{parameters.formatStr}}/${{parameters.name}}'
    displayName: Publish ${{parameters.name}} ${{parameters.formatStr}}
